<app-layout>
  <div class="produtos-container">

    <div class="produtos-header">
      <h1>Meus Produtos</h1>
    </div>

    <div *ngIf="isLoading" class="loading">
      <p>Carregando produtos...</p>
    </div>

    <div *ngIf="erro && !isLoading" class="alert alert-danger">
      {{ erro }}
    </div>

    <div *ngIf="!isLoading && produtos.length > 0" class="produtos-grid">
      <div *ngFor="let produto of produtos" class="produto-card">
        <div class="produto-header-card">
          <h3>{{ produto.nome }}</h3>
        </div>
        <p class="produto-descricao">{{ produto.descricao || 'Sem descri√ß√£o' }}</p>
        <div class="produto-info">
          <span class="info-item">
            <strong>Pre√ßo:</strong> R$ {{ produto.precoUnitario | number:'1.2-2' }}
          </span>
          <span class="info-item">
            <strong>Fornecedor:</strong> {{ produto.fornecedor }}
          </span>
          <span class="info-item">
            <strong>Marca:</strong> {{ produto.marca }}
          </span>
        </div>

        <div class="produto-acoes">
          <button class="btn-acao" (click)="abrirFormulario(produto)">‚úèÔ∏è</button>
          <button class="btn-delete btn-acao" *ngIf="produto.id !== null" (click)="deletarProduto(produto.id)">üóëÔ∏è</button>
        </div>
      </div>
    </div>

    <div *ngIf="showFormModal" class="modal-overlay" (click)="fecharFormulario()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h3>{{ isEditMode ? 'Editar Produto' : 'Adicionar Produto' }}</h3>
          <button class="btn-close" (click)="fecharFormulario()">‚úï</button>
        </div>
        <form class="modal-form">

          <div class="form-group">
            <label for="nome">Nome *</label>
            <input type="text" id="nome" [(ngModel)]="formData.nome" name="nome" class="form-control" />
          </div>

          <div class="form-group">
            <label for="fornecedor">Fornecedor *</label>
            <input type="text" id="fornecedor" [(ngModel)]="formData.fornecedor" name="fornecedor" class="form-control" />
          </div>

          <div class="form-group">
            <label for="marca">Marca *</label>
            <input type="text" id="marca" [(ngModel)]="formData.marca" name="marca" class="form-control" />
          </div>

          <div class="form-group">
            <label for="precoUnitario">Pre√ßo Unit√°rio *</label>
            <input type="number" id="precoUnitario" [(ngModel)]="formData.precoUnitario" name="precoUnitario" step="0.01" class="form-control" />
          </div>

          <div class="form-group">
            <label for="descricao">Descri√ß√£o</label>
            <textarea id="descricao" [(ngModel)]="formData.descricao" name="descricao" rows="3" class="form-control"></textarea>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn-secondary" (click)="fecharFormulario()">Cancelar</button>
            <button type="button" class="btn-primary" (click)="salvarProduto()">
              {{ isEditMode ? 'Atualizar' : 'Adicionar Produto' }}
            </button>
          </div>
        </form>

      </div>
    </div>

    <div *ngIf="!isLoading && produtos.length === 0" class="empty-state">
      <p>Voc√™ ainda n√£o cadastrou nenhum produto.</p>
    </div>
  </div>
</app-layout>
